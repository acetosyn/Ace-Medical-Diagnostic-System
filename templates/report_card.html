<div class="report-card p-6 rounded-lg bg-white shadow-md">
  <h3 class="text-lg font-semibold text-gray-800 mb-2">
    {{ "Patient Report" if section == 1 else "Quick Upload Report" }}
  </h3>

  <p><strong>Name:</strong> {{ data.name }}</p>
  {% if section == 1 %}
    <p><strong>Date of Birth:</strong> {{ data.dob }}</p>
    <p><strong>Sex:</strong> {{ data.sex }}</p>
    <p><strong>Symptoms:</strong> {{ data.symptoms | join(', ') }}</p>
    <p><strong>Medical History:</strong> {{ data.history | join(', ') }}</p>
    <p><strong>Additional Notes:</strong> {{ data.notes }}</p>
  {% endif %}

  {% if data.passport_b64 %}
    <div class="mt-4">
      <p class="text-sm text-gray-500 mb-1">Passport Photograph:</p>
      <img src="data:image/jpeg;base64,{{ data.passport_b64 }}" alt="Passport" class="w-32 h-32 object-cover rounded shadow" />
    </div>
  {% endif %}

  {% if section == 2 and data.lab_b64 %}
    <div class="mt-4">
      <p class="text-sm text-gray-500 mb-1">Lab Scan:</p>
      <img src="data:image/jpeg;base64,{{ data.lab_b64 }}" alt="Lab Scan" class="w-40 h-auto rounded shadow" />
    </div>
  {% elif data.report_scan_b64 %}
    <div class="mt-4">
      <p class="text-sm text-gray-500 mb-1">Scanned Report:</p>
      <img src="data:image/jpeg;base64,{{ data.report_scan_b64 }}" alt="Report Scan" class="w-40 h-auto rounded shadow" />
    </div>
  {% endif %}

  <div class="mt-6 flex flex-wrap gap-3">
    <button onclick="editSection({{ section }})" class="px-4 py-2 bg-gray-100 text-sm rounded hover:bg-gray-200">
      <i class="ri-edit-2-line mr-1"></i>Edit Details
    </button>
    <button onclick="downloadAsPDF({{ section }})" class="px-4 py-2 bg-gray-100 text-sm rounded hover:bg-gray-200">
      <i class="ri-file-pdf-line mr-1"></i>Download PDF
    </button>
    <button onclick="downloadAsPNG({{ section }})" class="px-4 py-2 bg-gray-100 text-sm rounded hover:bg-gray-200">
      <i class="ri-image-line mr-1"></i>Download PNG
    </button>
  </div>

  <!-- 🧠 AI Tools -->
  <div class="mt-10 border-t pt-6">
    <h4 class="text-lg font-semibold text-gray-800 mb-4">🧠 AI Tools for Report</h4>
    <div class="flex flex-wrap gap-4 mb-6">
      <button onclick="runLLM('simplify')" class="px-4 py-2 bg-blue-100 text-blue-800 rounded-button hover:bg-blue-200 transition">🧠 Simplify Report</button>
      <button onclick="runLLM('translate')" class="px-4 py-2 bg-green-100 text-green-800 rounded-button hover:bg-green-200 transition">🌐 Translate Report</button>
      <button onclick="runLLM('map_icd')" class="px-4 py-2 bg-yellow-100 text-yellow-800 rounded-button hover:bg-yellow-200 transition">📋 Map to Disease / ICD</button>
    </div>

    <!-- 💬 Chat Interface -->
    <div class="bg-gray-50 rounded-lg p-4 shadow-sm">
      <h5 class="text-sm text-gray-700 mb-2">💬 Ask a Question About This Report</h5>
      <div class="flex items-start gap-2">
        <textarea id="llm-chat-input" rows="2" class="form-input flex-1" placeholder="e.g. What does this finding suggest?"></textarea>
        <button id="llm-send-btn" class="bg-secondary text-white px-4 py-2 rounded-button hover:bg-secondary/90">Send</button>
      </div>
      <div id="llm-chat-output" class="mt-4 text-sm text-gray-800 bg-white p-3 rounded-md shadow-inner max-h-60 overflow-y-auto"></div>
    </div>
  </div>

  <div class="text-center mt-6">
    <button class="px-6 py-2 bg-secondary text-white rounded-button hover:bg-secondary/90" onclick="diagnoseBackend({{ section }})">
      Diagnose
    </button>
  </div>

  <div class="text-center mt-6">
    <button onclick="editSection({{ section }})" class="back-btn inline-flex items-center gap-2 px-5 py-2 text-sm rounded-button bg-gray-800 text-white hover:bg-gray-700 transition">
      <i class="ri-arrow-left-line"></i> Back to Form
    </button>
  </div>
</div>
